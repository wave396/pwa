
<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Archetype AI</title>
    <style>
        body { background: #121212; color: white; font-family: sans-serif; margin: 0; display: flex; flex-direction: column; height: 100vh; }
        .header { background: #222; padding: 10px; text-align: center; border-bottom: 1px solid #ff4d4d; }
        .chars { display: flex; justify-content: center; gap: 10px; padding: 10px; }
        .char-btn { background: #333; color: white; border: 1px solid #444; padding: 5px 15px; border-radius: 15px; }
        .char-btn.active { background: #ff4d4d; border-color: #ff4d4d; }
        #chat { flex: 1; overflow-y: auto; padding: 15px; display: flex; flex-direction: column; }
        .msg { margin: 5px 0; padding: 10px; border-radius: 10px; max-width: 80%; }
        .user { background: #007bff; align-self: flex-end; }
        .bot { background: #333; align-self: flex-start; }
        .input-box { display: flex; padding: 10px; background: #222; }
        input { flex: 1; padding: 10px; border-radius: 5px; border: none; margin-right: 5px; }
        button#send { background: #ff4d4d; color: white; border: none; padding: 10px 20px; border-radius: 5px; }
    </style>
</head>
<body>

<div class="header">ARCHETYPE AI</div>

<div class="chars">
    <button class="char-btn active" onclick="setChar('dracula', this)">Дракула</button>
    <button class="char-btn" onclick="setChar('trent', this)">Трент</button>
    <button class="char-btn" onclick="setChar('marie', this)">Мари</button>
</div>

<div id="chat">
    <div class="msg bot">Приветствую. Я готов к беседе.</div>
</div>

<div class="input-box">
    <input type="text" id="userInput" placeholder="Напишите сообщение...">
    <button id="send" onclick="sendMsg()">></button>
</div>

<script>
    const API_URL = "https://logic-q6qn.onrender.com/chat";
    let currentChar = 'dracula';

    function setChar(id, el) {
        currentChar = id;
        document.querySelectorAll('.char-btn').forEach(b => b.classList.remove('active'));
        el.classList.add('active');
    }

    async function sendMsg() {
        const input = document.getElementById('userInput');
        const chat = document.getElementById('chat');
        const text = input.value.trim();
        if (!text) return;

        chat.innerHTML += `<div class="msg user">${text}</div>`;
        input.value = "";

        try {
            const response = await fetch(API_URL, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ message: text, character: currentChar })
            });

            if (response.ok) {
                const data = await response.json();
                chat.innerHTML += `<div class="msg bot">${data.response}</div>`;
            } else {
                chat.innerHTML += `<div class="msg bot" style="color:red">Ошибка сервера: ${response.status}</div>`;
            }
        } catch (err) {
            chat.innerHTML += `<div class="msg bot" style="color:red">Ошибка сети: убедитесь, что адрес ${API_URL} доступен в браузере.</div>`;
            console.error(err);
        }
        chat.scrollTop = chat.scrollHeight;
    }
</script>
</body>
</html>
